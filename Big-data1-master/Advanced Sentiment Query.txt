select year(from_unixtime(r.time)) as year,month(from_unixtime(r.time)) as month,round(avg(r.rating),1) as avg_rating,max(r.rating) as max,min(r.rating) as min, count(r.rating) as number_of_ratings, max(t.rating) as Most_popular_tag from movierating r join movietags t on t.user_id = r.user_id and t.movie_id = r.movie_id where r.time is not null and r.rating >=4.5 group by month(from_unixtime(r.time)),year(from_unixtime(r.time)) order by year,month;
select year(from_unixtime(r.time)) as year,month(from_unixtime(r.time)) as month,round(avg(r.rating),1) as avg_rating,max(r.rating) as max,min(r.rating) as min, count(r.rating) as number_of_ratings, max(t.rating) as Most_popular_tag from movierating r join movietags t on t.user_id = r.user_id and t.movie_id = r.movie_id where r.time is not null and r.rating <=1 group by month(from_unixtime(r.time)),year(from_unixtime(r.time)) order by year,month;
